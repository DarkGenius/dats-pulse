# DatsPulse Game Bot

Игровой бот для участия в стратегической игре DatsPulse - управление колонией муравьев на гексагональной карте.

## Особенности

- **Трехфазовая стратегия**: Экономическая экспансия → Сбалансированное развитие → Доминирование
- **Адаптивный ИИ**: Анализ игровой ситуации и динамическое принятие решений
- **Оптимизация ресурсов**: Приоритизация нектара (60 калорий) над хлебом (25) и яблоками (10)
- **Умное управление рисками**: Система безопасности с анализом угроз и end-game ограничениями

## Установка и запуск

1. Установите зависимости:
```bash
npm install
```

2. Настройте переменные окружения:
```bash
cp .env.example .env
```

3. Отредактируйте `.env` файл:
```env
API_URL=https://games.datsteam.dev/api
API_TOKEN=your_api_token_here
TEAM_NAME=Drive Core
LOG_LEVEL=INFO
```

4. Запустите бота:
```bash
node index.js
```

## Архитектура

### Основные компоненты:

- **GameBot** - Главный класс, координирующий работу всех систем
- **ApiClient** - HTTP клиент для взаимодействия с API игры
- **GameAnalyzer** - Анализ игрового состояния и оценка ситуации
- **StrategyManager** - Трехфазовая стратегия и принятие решений
- **UnitManager** - Управление юнитами и их поведением
- **ResourceManager** - Сбор ресурсов и логистика
- **CombatManager** - Боевые формации и тактики

### Стратегия по фазам:

**Фаза 1: Экономическая экспансия (ходы 1-20)**
- Рабочие: 60% (сбор ресурсов)
- Разведчики: 30% (картирование, поиск нектара)
- Бойцы: 10% (базовая защита)

**Фаза 2: Сбалансированная экспансия (ходы 21-50)**
- Рабочие: 50% (поддержание экономики)
- Разведчики: 25% (контроль территории)
- Бойцы: 25% (военная готовность)

**Фаза 3: Оптимизация доминирования (ходы 51+)**
- Адаптивные пропорции в зависимости от ситуации
- Фокус на высокоценные ресурсы
- Подавление конкурентов

### Алгоритм принятия решений:

```javascript
IF (обнаружен_нектар_в_радиусе_7) → производить_разведчика()
ELSE IF (угроза_низкая) → производить_рабочего()  
ELSE → производить_бойца()
```

## Продвинутая боевая система

### 6-факторная оценка угроз:
1. **DPS анализ**: Урон × процент здоровья
2. **Активная атака**: Обнаружение врагов в бою с нашими юнитами (+100 бонус)
3. **Экономическая угроза**: Враги рядом с рабочими (+25 за рабочего, +30/+50 бонусы)
4. **Расстояние до базы**: max(0, 30 - расстояние) × 2
5. **Фактор здоровья**: max(0, 100 - здоровье) × 1.5
6. **Базовая угроза типа**: Солдат: 40, Разведчик: 20, Рабочий: 5

### Фокусировка огня:
- Все солдаты атакуют цель с наивысшим приоритетом
- Координация атак для максимальной эффективности
- Приоритет защиты муравейника (враги ≤8 гексов)

### Адаптивные контр-тактики:
- **Против экономической стратегии**: Агрессивное преследование + военная подготовка
- **Против военной лихорадки**: Оборонительная позиция + минимум 50% солдат
- **Против разведки**: Усиление обороны базы + анти-разведывательные меры

## Оптимизация ресурсов

### Приоритеты сбора:
1. **Нектар** (60 калорий) - расстояние ≤ 6 гексов
2. **Хлеб** (25 калорий) - расстояние ≤ 4 гексов
3. **Яблоки** (10 калорий) - любое расстояние

### Специализация юнитов:
- **Рабочие (Worker, тип 1)**: Эффективны для хлеба и яблок (грузоподъемность 8)
- **Солдаты (Soldier, тип 2)**: Боевые единицы, менее эффективны в сборе
- **Разведчики (Scout, тип 3)**: Оптимальны для сбора нектара (скорость 7, обзор 4)

### Типы ресурсов:
- **Яблоки (Apple, тип 1)**: 10 калорий
- **Хлеб (Bread, тип 2)**: 25 калорий  
- **Нектар (Nectar, тип 3)**: 60 калорий

## Мониторинг и отладка

Бот ведет подробные логи всех действий:
- Анализ игрового состояния
- Принятие стратегических решений
- Управление юнитами
- Боевые действия
- Оптимизация ресурсов

Для включения отладочных сообщений:
```env
LOG_LEVEL=DEBUG
```

## Метрики эффективности

### Целевые показатели:
- Ранняя игра: 200+ калорий/ход
- Средняя игра: 500+ калорий/ход
- Поздняя игра: 800+ калорий/ход

### Критические пороги:
- Минимум 25% рабочих от общей популяции
- Максимум 60% боевых единиц в кризисных ситуациях
- Постоянно 20-35% разведчиков для контроля информации

## Техническая реализация

- **Node.js** - Основная платформа
- **HTTP API** - Взаимодействие с игровым сервером
- **Гексагональная математика** - Расчеты расстояний и движения
- **Адаптивные алгоритмы** - Реагирование на изменения ситуации

